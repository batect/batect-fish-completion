containers:
  editorconfig-checker:
    image: mstruebing/editorconfig-checker:2.1.0
    volumes:
      - local: .
        container: /code
        options: ro
    working_directory: /code

  yamllint:
    build_directory: .batect/yamllint
    volumes:
      - local: .
        container: /code
        options: ro
    working_directory: /code

  yapf:
    build_directory: .batect/yapf
    volumes:
      - local: .
        container: /code
        options: ro
    working_directory: /code

tasks:
  check-format:
    description: Run all formatting check tasks.
    group: Formatting check tasks
    prerequisites:
      - check-format:*

  check-format:editorconfig-compliance:
    description: Check formatting of all files against the configuration in .editorconfig.
    group: Formatting check tasks
    run:
      container: editorconfig-checker
      command: ec

  check-format:python:
    description: Check formatting of Python code.
    group: Formatting check tasks
    run:
      container: yapf
      command: yapf --diff --recursive .

  check-format:yaml:
    description: Check formatting of all YAML files.
    group: Formatting check tasks
    run:
      container: yamllint
      command: yamllint --strict .

  lint:
    description: Run all linting tasks.
    group: Linting tasks
    prerequisites:
      - lint:*

include:
  - type: git
    repo: https://github.com/batect/hadolint-bundle.git
    ref: 0.3.0
